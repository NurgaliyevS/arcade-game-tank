<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Tank Arcade Game</title>
    <link rel="stylesheet" href="style.css">
    <!-- Load p5.js from CDN -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/p5.js/1.7.0/p5.js"></script>
</head>
<body>
    <div id="p5_loading">Initializing AI Core...</div>
    
    <!-- Sound loading with fallbacks -->
    <script>
        // Function to load p5.sound with fallbacks
        function loadP5Sound() {
            return new Promise((resolve, reject) => {
                // First attempt - CDNJS
                const script1 = document.createElement('script');
                script1.src = 'https://cdnjs.cloudflare.com/ajax/libs/p5.js/1.7.0/addons/p5.sound.min.js';
                script1.onload = () => {
                    console.log('p5.sound loaded from CDNJS');
                    resolve();
                };
                script1.onerror = () => {
                    console.warn('Failed to load p5.sound from CDNJS, trying jsdelivr...');
                    
                    // Second attempt - jsdelivr
                    const script2 = document.createElement('script');
                    script2.src = 'https://cdn.jsdelivr.net/npm/p5/lib/addons/p5.sound.min.js';
                    script2.onload = () => {
                        console.log('p5.sound loaded from jsdelivr');
                        resolve();
                    };
                    script2.onerror = () => {
                        console.error('Failed to load p5.sound from all sources');
                        reject(new Error('Failed to load p5.sound'));
                    };
                    document.head.appendChild(script2);
                };
                document.head.appendChild(script1);
            });
        }

        // Load p5.sound after page loads
        window.addEventListener('load', function() {
            loadP5Sound()
                .then(() => {
                    console.log('p5.sound loaded successfully');
                    // Initialize audio context if needed
                    if (typeof p5 !== 'undefined' && typeof p5.prototype.getAudioContext === 'function') {
                        new p5().getAudioContext().resume();
                    }
                })
                .catch(err => {
                    console.error('Error loading p5.sound:', err);
                    alert('Could not load sound library. Some features may not work.');
                });
        });
    </script>
    
    <script src="sketch.js"></script>
</body>
</html>